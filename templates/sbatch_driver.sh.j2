#!/bin/bash
#SBATCH --job-name=obsForgeValidate_{{ date_start }}_to_{{ date_end }}
#SBATCH --output=obsForgeValidate_{{ date_start }}_to_{{ date_end }}.%j.out
#SBATCH --error=obsForgeValidate_{{ date_start }}_to_{{ date_end }}.%j.err
#SBATCH --time={{ job_time | default('00:05:00') }}
#SBATCH --ntasks={{ ntasks | default(4) }}
#SBATCH --account=da-cpu


outputdir="{{ cycle_type }}_obs_validation_{{ date_start }}-{{ date_end }}"
socascratch="{{ socascratch | default('/scratch3/NCEPDEV/da/Guillaume.Vernieres/socascratch') }}"
jedi_root="{{ jedi_root | default('/scratch3/NCEPDEV/da/Guillaume.Vernieres/sandboxes/global-workflow/sorc/gdas.cd') }}"
obsforge_db="{{ obsforge_db | default('/scratch3/NCEPDEV/da/common_obsForge') }}"

module use ${jedi_root}/modulefiles
module load GDAS/{{ hpc_modules }}

python {{ home_obsforge_validate }}/apps/obsforge_cycle_processor.py \
      --obsforge ${obsforge_db} \
      --jcb-gdas-path {{ home_obsforge_validate }}/jcb-gdas/ \
      --cycle-type {{ cycle_type }} \
      --execution-mode bash \
      --date-range {{ date_start }} {{ date_end }} \
      --jedi-root ${jedi_root} \
      --socascratch ${socascratch} \
      --output-dir ${outputdir} \
